[2022-05-24 08:11:22,183] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: TRAVELOKA_V1.crawl_data manual__2022-05-24T08:11:17.607486+00:00 [queued]>
[2022-05-24 08:11:22,198] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: TRAVELOKA_V1.crawl_data manual__2022-05-24T08:11:17.607486+00:00 [queued]>
[2022-05-24 08:11:22,198] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2022-05-24 08:11:22,198] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2022-05-24 08:11:22,198] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2022-05-24 08:11:23,251] {taskinstance.py:1377} INFO - Executing <Task(BashOperator): crawl_data> on 2022-05-24 08:11:17.607486+00:00
[2022-05-24 08:11:23,265] {standard_task_runner.py:52} INFO - Started process 85 to run task
[2022-05-24 08:11:23,277] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'TRAVELOKA_V1', 'crawl_data', 'manual__2022-05-24T08:11:17.607486+00:00', '--job-id', '110', '--raw', '--subdir', 'DAGS_FOLDER/test/test.py', '--cfg-path', '/tmp/tmp0xv26cu2', '--error-file', '/tmp/tmpro0uoctw']
[2022-05-24 08:11:23,278] {standard_task_runner.py:80} INFO - Job 110: Subtask crawl_data
[2022-05-24 08:11:24,833] {task_command.py:369} INFO - Running <TaskInstance: TRAVELOKA_V1.crawl_data manual__2022-05-24T08:11:17.607486+00:00 [running]> on host aae532274ed6
[2022-05-24 08:11:26,606] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=TRAVELOKA_V1
AIRFLOW_CTX_DAG_ID=TRAVELOKA_V1
AIRFLOW_CTX_TASK_ID=crawl_data
AIRFLOW_CTX_EXECUTION_DATE=2022-05-24T08:11:17.607486+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-05-24T08:11:17.607486+00:00
[2022-05-24 08:11:26,607] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2022-05-24 08:11:26,608] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'cd /opt/***/dags/test && scrapy crawl hotel']
[2022-05-24 08:11:26,617] {subprocess.py:85} INFO - Output:
[2022-05-24 08:11:28,387] {subprocess.py:92} INFO - /opt/***/dags/test/hotel/items.py:5: ScrapyDeprecationWarning: scrapy.loader.processors.TakeFirst is deprecated, instantiate itemloaders.processors.TakeFirst instead.
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO -   hotel_name = scrapy.Field(output_processor=TakeFirst())
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO - /opt/***/dags/test/hotel/items.py:6: ScrapyDeprecationWarning: scrapy.loader.processors.TakeFirst is deprecated, instantiate itemloaders.processors.TakeFirst instead.
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO -   hotel_rating = scrapy.Field(output_processor=TakeFirst())
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO - /opt/***/dags/test/hotel/items.py:7: ScrapyDeprecationWarning: scrapy.loader.processors.TakeFirst is deprecated, instantiate itemloaders.processors.TakeFirst instead.
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO -   hotel_address = scrapy.Field(output_processor=TakeFirst())
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO - /opt/***/dags/test/hotel/items.py:8: ScrapyDeprecationWarning: scrapy.loader.processors.TakeFirst is deprecated, instantiate itemloaders.processors.TakeFirst instead.
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO -   hotel_point_review = scrapy.Field(output_processor=TakeFirst())
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO - /opt/***/dags/test/hotel/items.py:9: ScrapyDeprecationWarning: scrapy.loader.processors.TakeFirst is deprecated, instantiate itemloaders.processors.TakeFirst instead.
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO -   hotel_sum_review = scrapy.Field(output_processor=TakeFirst())
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO - /opt/***/dags/test/hotel/items.py:10: ScrapyDeprecationWarning: scrapy.loader.processors.TakeFirst is deprecated, instantiate itemloaders.processors.TakeFirst instead.
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO -   hotel_url = scrapy.Field(output_processor=TakeFirst())
[2022-05-24 08:11:28,388] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.utils.log] INFO: Scrapy 2.6.1 started (bot: hotel)
[2022-05-24 08:11:28,393] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.utils.log] INFO: Versions: lxml 4.8.0.0, libxml2 2.9.12, cssselect 1.1.0, parsel 1.6.0, w3lib 1.22.0, Twisted 22.4.0, Python 3.7.13 (default, Apr 20 2022, 06:19:04) - [GCC 10.2.1 20210110], pyOpenSSL 21.0.0 (OpenSSL 1.1.1n  15 Mar 2022), cryptography 36.0.2, Platform Linux-5.4.0-110-generic-x86_64-with-debian-11.3
[2022-05-24 08:11:28,399] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.crawler] INFO: Overridden settings:
[2022-05-24 08:11:28,399] {subprocess.py:92} INFO - {'BOT_NAME': 'hotel',
[2022-05-24 08:11:28,399] {subprocess.py:92} INFO -  'DOWNLOAD_DELAY': 5,
[2022-05-24 08:11:28,399] {subprocess.py:92} INFO -  'FEED_EXPORT_ENCODING': 'utf-8',
[2022-05-24 08:11:28,399] {subprocess.py:92} INFO -  'NEWSPIDER_MODULE': 'hotel.spiders',
[2022-05-24 08:11:28,399] {subprocess.py:92} INFO -  'SPIDER_MODULES': ['hotel.spiders']}
[2022-05-24 08:11:28,402] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.utils.log] DEBUG: Using reactor: twisted.internet.epollreactor.EPollReactor
[2022-05-24 08:11:28,414] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.extensions.telnet] INFO: Telnet Password: eeddf8e9ec0bd417
[2022-05-24 08:11:28,457] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.middleware] INFO: Enabled extensions:
[2022-05-24 08:11:28,457] {subprocess.py:92} INFO - ['scrapy.extensions.corestats.CoreStats',
[2022-05-24 08:11:28,457] {subprocess.py:92} INFO -  'scrapy.extensions.telnet.TelnetConsole',
[2022-05-24 08:11:28,458] {subprocess.py:92} INFO -  'scrapy.extensions.memusage.MemoryUsage',
[2022-05-24 08:11:28,458] {subprocess.py:92} INFO -  'scrapy.extensions.logstats.LogStats']
[2022-05-24 08:11:28,577] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.middleware] INFO: Enabled downloader middlewares:
[2022-05-24 08:11:28,577] {subprocess.py:92} INFO - ['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
[2022-05-24 08:11:28,577] {subprocess.py:92} INFO -  'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
[2022-05-24 08:11:28,577] {subprocess.py:92} INFO -  'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
[2022-05-24 08:11:28,577] {subprocess.py:92} INFO -  'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
[2022-05-24 08:11:28,577] {subprocess.py:92} INFO -  'scrapy.downloadermiddlewares.retry.RetryMiddleware',
[2022-05-24 08:11:28,577] {subprocess.py:92} INFO -  'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
[2022-05-24 08:11:28,577] {subprocess.py:92} INFO -  'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
[2022-05-24 08:11:28,577] {subprocess.py:92} INFO -  'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
[2022-05-24 08:11:28,578] {subprocess.py:92} INFO -  'scrapy.downloadermiddlewares.cookies.CookiesMiddleware',
[2022-05-24 08:11:28,578] {subprocess.py:92} INFO -  'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
[2022-05-24 08:11:28,578] {subprocess.py:92} INFO -  'scrapy.downloadermiddlewares.stats.DownloaderStats']
[2022-05-24 08:11:28,579] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.middleware] INFO: Enabled spider middlewares:
[2022-05-24 08:11:28,580] {subprocess.py:92} INFO - ['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
[2022-05-24 08:11:28,580] {subprocess.py:92} INFO -  'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
[2022-05-24 08:11:28,580] {subprocess.py:92} INFO -  'scrapy.spidermiddlewares.referer.RefererMiddleware',
[2022-05-24 08:11:28,580] {subprocess.py:92} INFO -  'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
[2022-05-24 08:11:28,580] {subprocess.py:92} INFO -  'scrapy.spidermiddlewares.depth.DepthMiddleware']
[2022-05-24 08:11:28,602] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,608] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,612] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,618] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,624] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,629] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,634] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,640] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,644] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,649] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,653] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,659] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,663] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,668] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,672] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,676] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,681] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,685] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,690] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,694] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,698] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,702] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,707] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,712] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,716] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,721] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,726] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,731] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,734] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,739] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,743] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,747] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,752] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,756] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,761] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,765] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,769] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,773] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,778] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,782] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,786] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,791] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,797] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,801] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,805] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,809] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,814] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,818] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,823] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,827] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [root] ERROR: (1049, "Unknown database 'HOTEL'")
[2022-05-24 08:11:28,827] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.middleware] INFO: Enabled item pipelines:
[2022-05-24 08:11:28,827] {subprocess.py:92} INFO - ['hotel.pipelines.QuotesSpiderPipeline']
[2022-05-24 08:11:28,827] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.core.engine] INFO: Spider opened
[2022-05-24 08:11:28,949] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
[2022-05-24 08:11:28,950] {subprocess.py:92} INFO - 2022-05-24 08:11:28 [scrapy.extensions.telnet] INFO: Telnet console listening on 127.0.0.1:6023
[2022-05-24 08:11:29,286] {subprocess.py:92} INFO - 2022-05-24 08:11:29 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (308) to <GET https://www.traveloka.com/vi-vn/hotel> from <GET https://www.traveloka.com/vi-vn/hotel/>
[2022-05-24 08:11:35,992] {subprocess.py:92} INFO - 2022-05-24 08:11:35 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://www.traveloka.com/vi-vn/hotel> (referer: None)
[2022-05-24 08:11:40,995] {subprocess.py:92} INFO - 2022-05-24 08:11:40 [tldextract.cache] WARNING: unable to cache publicsuffix.org-tlds.{'urls': ('https://publicsuffix.org/list/public_suffix_list.dat', 'https://raw.githubusercontent.com/publicsuffix/list/master/public_suffix_list.dat'), 'fallback_to_snapshot': True} in /home/***/.cache/python-tldextract/3.7.13.final__local__ecb11d__tldextract-3.3.0/publicsuffix.org-tlds/de84b5ca2167d4c83e38fb162f2e8738.tldextract.json. This could refresh the Public Suffix List over HTTP every app startup. Construct your `TLDExtract` with a writable `cache_dir` or set `cache_dir=None` to silence this warning. [Errno 13] Permission denied: '/home/***/.cache/python-tldextract'
[2022-05-24 08:11:41,006] {subprocess.py:92} INFO - 2022-05-24 08:11:41 [urllib3.connectionpool] DEBUG: Starting new HTTPS connection (1): publicsuffix.org:443
[2022-05-24 08:11:41,149] {subprocess.py:92} INFO - 2022-05-24 08:11:41 [urllib3.connectionpool] DEBUG: https://publicsuffix.org:443 "GET /list/public_suffix_list.dat HTTP/1.1" 200 None
[2022-05-24 08:11:41,203] {subprocess.py:92} INFO - 2022-05-24 08:11:41 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (301) to <GET https://www.traveloka.com/vi-vn/hotel/vietnam/region/da-nang-10010083> from <GET https://www.traveloka.com/vi-vn/hotel/vietnam/region/da-nang-city-10010083>
[2022-05-24 08:11:48,005] {subprocess.py:92} INFO - 2022-05-24 08:11:48 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://www.traveloka.com/vi-vn/hotel/vietnam/city/ha-long-city-30010278> (referer: https://www.traveloka.com/vi-vn/hotel)
[2022-05-24 08:11:53,603] {subprocess.py:92} INFO - 2022-05-24 08:11:53 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://www.traveloka.com/vi-vn/hotel/vietnam/region/ho-chi-minh-city-10009794> (referer: https://www.traveloka.com/vi-vn/hotel)
[2022-05-24 08:11:53,760] {subprocess.py:92} INFO - 2022-05-24 08:11:53 [scrapy.dupefilters] DEBUG: Filtered duplicate request: <GET https://www.traveloka.com/vi-vn/hotel/vietnam/region/da-nang-10010083> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
[2022-05-24 08:11:57,785] {subprocess.py:92} INFO - 2022-05-24 08:11:57 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://www.traveloka.com/vi-vn/hotel/vietnam/city/hue-city-10010311> (referer: https://www.traveloka.com/vi-vn/hotel)
[2022-05-24 08:12:02,051] {subprocess.py:92} INFO - 2022-05-24 08:12:02 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://www.traveloka.com/vi-vn/hotel/vietnam/city/quy-nhon-city-10009975> (referer: https://www.traveloka.com/vi-vn/hotel)
[2022-05-24 08:12:07,242] {subprocess.py:92} INFO - 2022-05-24 08:12:07 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://www.traveloka.com/vi-vn/hotel/vietnam/city/phan-thiet-10010286> (referer: https://www.traveloka.com/vi-vn/hotel)
[2022-05-24 08:12:12,933] {subprocess.py:92} INFO - 2022-05-24 08:12:12 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (301) to <GET https://www.traveloka.com/vi-vn/hotel/vietnam/city/hoi-an-10010308> from <GET https://www.traveloka.com/vi-vn/hotel/vietnam/city/hoi-an-ancient-town-10010308>
[2022-05-24 08:12:16,844] {subprocess.py:92} INFO - 2022-05-24 08:12:16 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (301) to <GET https://www.traveloka.com/vi-vn/hotel/vietnam/city/da-lat-10010169> from <GET https://www.traveloka.com/vi-vn/hotel/vietnam/city/da-lat-city-10010169>
[2022-05-24 08:12:22,795] {subprocess.py:92} INFO - 2022-05-24 08:12:22 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (301) to <GET https://www.traveloka.com/vi-vn/hotel/vietnam/region/hanoi-10009843> from <GET https://www.traveloka.com/vi-vn/hotel/vietnam/region/ha-noi-city-10009843>
[2022-05-24 08:12:28,949] {subprocess.py:92} INFO - 2022-05-24 08:12:28 [scrapy.extensions.logstats] INFO: Crawled 6 pages (at 6 pages/min), scraped 0 items (at 0 items/min)
[2022-05-24 08:12:30,083] {subprocess.py:92} INFO - 2022-05-24 08:12:30 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://www.traveloka.com/vi-vn/hotel/vietnam/city/vung-tau-city-10009888> (referer: https://www.traveloka.com/vi-vn/hotel)
[2022-05-24 08:12:35,547] {subprocess.py:92} INFO - 2022-05-24 08:12:35 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://www.traveloka.com/vi-vn/hotel/vietnam/city/phu-quoc-10011570> (referer: https://www.traveloka.com/vi-vn/hotel)
[2022-05-24 08:12:39,098] {local_task_job.py:221} WARNING - State of this instance has been externally set to None. Terminating instance.
[2022-05-24 08:12:39,101] {process_utils.py:129} INFO - Sending Signals.SIGTERM to group 85. PIDs of all processes in the group: [86, 85]
[2022-05-24 08:12:39,101] {process_utils.py:80} INFO - Sending the signal Signals.SIGTERM to group 85
[2022-05-24 08:12:39,102] {taskinstance.py:1541} ERROR - Received SIGTERM. Terminating subprocesses.
[2022-05-24 08:12:39,102] {subprocess.py:103} INFO - Sending SIGTERM signal to process group
[2022-05-24 08:12:39,127] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/bash.py", line 189, in execute
    cwd=self.cwd,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/subprocess.py", line 90, in run_command
    for raw_line in iter(self.sub_process.stdout.readline, b''):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1543, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2022-05-24 08:12:39,132] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=TRAVELOKA_V1, task_id=crawl_data, execution_date=20220524T081117, start_date=20220524T081122, end_date=20220524T081239
[2022-05-24 08:12:39,151] {standard_task_runner.py:97} ERROR - Failed to execute job 110 for task crawl_data ((psycopg2.errors.ForeignKeyViolation) insert or update on table "task_fail" violates foreign key constraint "task_fail_ti_fkey"
DETAIL:  Key (dag_id, task_id, run_id, map_index)=(TRAVELOKA_V1, crawl_data, manual__2022-05-24T08:11:17.607486+00:00, -1) is not present in table "task_instance".

[SQL: INSERT INTO task_fail (task_id, dag_id, run_id, map_index, start_date, end_date, duration) VALUES (%(task_id)s, %(dag_id)s, %(run_id)s, %(map_index)s, %(start_date)s, %(end_date)s, %(duration)s) RETURNING task_fail.id]
[parameters: {'task_id': 'crawl_data', 'dag_id': 'TRAVELOKA_V1', 'run_id': 'manual__2022-05-24T08:11:17.607486+00:00', 'map_index': -1, 'start_date': datetime.datetime(2022, 5, 24, 8, 11, 22, 184042, tzinfo=Timezone('UTC')), 'end_date': datetime.datetime(2022, 5, 24, 8, 12, 39, 131954, tzinfo=Timezone('UTC')), 'duration': 76}]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 85)
[2022-05-24 08:12:39,194] {process_utils.py:75} INFO - Process psutil.Process(pid=85, status='terminated', exitcode=1, started='08:11:22') (85) terminated with exit code 1
